function getRandomInteger(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t))+t}function shuffle(t){for(var e=t.length;e;e-=1){var n=Math.floor(Math.random()*e),i=t[e-1];t[e-1]=t[n],t[n]=i}}var LOADER_HIDE=0,LOADER_SHOW=1;function appendLoader(t){if($("#overlay").length&&$("#overlay").remove(),t===LOADER_SHOW){var e=$('<div id="overlay"><div id="loader"><img id="loading" src="images/logo-airpay.png"></div></div>');e.show(),e.appendTo(document.body)}}$(document).ready(function(){var t=[];$("select:not(.ignore)").niceSelect(),$(".accordion").accordion({firstChildExpand:!0,multiExpand:!1,slideSpeed:500,dropDownIcon:'<img src="images/down-chevron.png" width="24"/>'});var e=window.innerWidth>=1600?1:window.innerWidth/1600;$("body").css({zoom:e}),$(window).on("resize",function(){$("body").css({zoom:e})});var n={searching:!1,paging:!1,ordering:!1,info:!1,columns:[{title:"Tên nhân viên"},{title:"Số điện thoại"}]},i=$.extend(!0,{},n);i.dom="Bfrtip";var a=$.extend(!0,{},i);a.buttons=[{extend:"excelHtml5",title:"DailyAirPay_7th_Prize"}];var r=$.extend(!0,{},i);r.buttons=[{extend:"excelHtml5",title:"DailyAirPay_6th_Prize"}];var o=$.extend(!0,{},i);o.buttons=[{extend:"excelHtml5",title:"DailyAirPay_5th_Prize"}];var l=$.extend(!0,{},i);l.buttons=[{extend:"excelHtml5",title:"DailyAirPay_4th_Prize"}];var d=$.extend(!0,{},i);d.buttons=[{extend:"excelHtml5",title:"DailyAirPay_3rd_Prize"}];var h=$.extend(!0,{},i);h.buttons=[{extend:"excelHtml5",title:"DailyAirPay_2nd_Prize"}];var s=$.extend(!0,{},i);s.buttons=[{extend:"excelHtml5",title:"DailyAirPay_1st_Prize"}];var c={7:[a,"Giải may mắn - 10.000Đ"],6:[r,"Giải may mắn - 50.000Đ"],5:[o,"Giải may mắn - 100.000Đ"],4:[l,"Giải Thịnh Vượng"],3:[d,"Giải An Khang"],2:[h,"Giải Phú Quý"],1:[s,"Giải Lộc Xuân"]};function u(e){var i=e.target.files[0],a=new FileReader;a.onload=function(e){var i=e.target.result,a=XLSX.read(i,{type:"binary"});a.SheetNames.forEach(function(e){var i=XLSX.utils.sheet_to_json(a.Sheets[e]);$.each(i,function(e,n){var i=n.name||"",a=n.phone||"";if(""!==i||""!==a){var r=[i,a];t.push(r)}});var r=$.extend(!0,{},n);r.data=t.slice(0,1e3);var o=$("#input_table");o.DataTable(r),o.show(),$("#input_file").hide()})},a.readAsBinaryString(i)}$(".btn_trigger").on("click",function(){shuffle(t);var e=parseInt($(this).attr("data-id")),n=$("#quantity_"+e),i=parseInt(n.val())||0;if(i<=0)return alert("Vui lòng nhập số lượng quay thưởng hợp lệ !"),!1;if(i>t.length)return alert("Số lượng quay thưởng không được lớn hơn danh sách quay thưởng (Còn lại: "+t.length+" nhân viên) !"),!1;n.attr("readonly",""),$(this).css("-webkit-filter","grayscale(100%)"),$(this).prop("disabled",!0);for(var a=[],r=[],o=0;o<i;o++){if(!(t.length>0)){alert("Giải đã được trao hết !");break}var l=getRandomInteger(0,t.length-1),d=t[l];a.push(d),r.push(d[1]),t.splice(l,1)}appendLoader(LOADER_SHOW),window.setTimeout(function(){var t=r.join(", ");$("#result_"+e).val(t);var n=$("#output_table_"+e);$.each(a,function(t,e){for(t=0;t<e.length;t++)e[t]+='<hr class="hr-table">'});var i=c[e][0];i.data=a,n.DataTable(i),n.show(),appendLoader(LOADER_HIDE)},getRandomInteger(1e3,3e3))}),$("#result_title").text(c[7][1]),$(".drawer").on("click",function(){var t=parseInt($(this).find(".btn_trigger").attr("data-id")),e=c[t][1];$("#result_title").text(e),$(".output").hide(),$(".btn_export").attr("data-id",t),$("#output_table_"+t).show()}),$(".btn_export").on("click",function(){var t=parseInt($(this).attr("data-id"));$("#output_table_"+t+"_wrapper").find(".buttons-excel").click()}),$(function(){var e=document.getElementById("input_file");e.addEventListener&&(t.length=0,e.addEventListener("change",u,!1))})});