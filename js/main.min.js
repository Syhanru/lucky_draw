$(document).ready(function(){var s=[];$("select:not(.ignore)").niceSelect(),$(".accordion").accordion({firstChildExpand:!0,multiExpand:!1,slideSpeed:500,dropDownIcon:'<img src="images/apc/down-chevron.png" width="24"/>'});var t=1600<=window.innerWidth?1:window.innerWidth/1600;$("body").css({zoom:t}),$(window).on("resize",function(){$("body").css({zoom:t})});var e={searching:!1,paging:!1,ordering:!1,info:!1,columns:[{title:"Mã hóa đơn"},{title:"Serial"}]},n=$("#input_table");n.DataTable(e);var i=n.DataTable(),a=$.extend(!0,{},e);a.dom="Bfrtip";var r=$.extend(!0,{},a);r.buttons=[{extend:"excelHtml5",title:"DailyAirPay_4th_Prize"}],$("#output_table_4").DataTable(r);var o=$.extend(!0,{},a);o.buttons=[{extend:"excelHtml5",title:"DailyAirPay_3rd_Prize"}],$("#output_table_3").DataTable(o);var l=$.extend(!0,{},a);l.buttons=[{extend:"excelHtml5",title:"DailyAirPay_2nd_Prize"}],$("#output_table_2").DataTable(l);var d=$.extend(!0,{},a);d.buttons=[{extend:"excelHtml5",title:"DailyAirPay_1st_Prize"}],$("#output_table_1").DataTable(d),$(".btn_trigger").on("click",function(){!function(t){for(var e=t.length;e;e-=1){var a=Math.floor(Math.random()*e),r=t[e-1];t[e-1]=t[a],t[a]=r}}(s);for(var t=parseInt($(this).attr("data-id")),e=parseInt($("#quantity_"+t).val())||0,a=[],r=[],n=0;n<e;n++){if(!(0<s.length)){alert("Giải đã được trao hết !");break}var i=s[0];a.push(i),r.push(i[1]);for(var o=0;o<s.length;)s[o][1]===a[n][1]?s.splice(o,1):o++}var l=r.join(", ");$("#result_"+t).val(l);var d=$("#output_table_"+t),c=d.DataTable();$.each(a,function(t,e){c.row.add(e).draw(!1)}),d.show(),$(this).css("-webkit-filter","grayscale(100%)"),$(this).prop("disabled",!0)}),$(".drawer").on("click",function(){var t=parseInt($(this).find(".btn_trigger").attr("data-id")),e="";switch(t){case 1:e="nhất";break;case 2:e="nhì";break;case 3:e="ba";break;case 4:e="khuyến khích"}$("#result_title").text(e),$(".output").hide(),$(".btn_export").attr("data-id",t);var a=$("#output_table_"+t);a.DataTable().page.info().recordsTotal&&a.show()}),$(".btn_export").on("click",function(){var t=parseInt($(this).attr("data-id"));$("#output_table_"+t+"_wrapper").find(".buttons-excel").click()});var c=$("#input_file");function u(t){var e=t.target.files[0],a=(e.name,new FileReader);a.onload=function(t){var e=t.target.result,a=XLS.CFB.read(e,{type:"binary"}),r=XLS.parse_xlscfb(a);r.SheetNames.forEach(function(t){XLS.utils.make_csv(r.Sheets[t]);var e=XLS.utils.sheet_to_row_object_array(r.Sheets[t]);$.each(e,function(t,e){var a=e.ma_hoa_don||"",r=e.serial||"";if(""!==a||""!==r){var n=[a,r];s.push(n),i.row.add(n).draw(!1)}}),n.show(),c.hide()})},a.readAsBinaryString(e)}$(function(){var t=document.getElementById("input_file");t.addEventListener&&(i.clear().draw(),s.length=0,t.addEventListener("change",u,!1))})});